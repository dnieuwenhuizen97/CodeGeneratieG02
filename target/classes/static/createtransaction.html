<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Get All Transactions</title>
    <link
            href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,700;1,300&display=swap"
            rel="stylesheet"
    />
    <link
            rel="stylesheet"
            href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
            integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
            crossorigin="anonymous"
    >
    <link
            rel="stylesheet"
            type="text/css"
            href="css/style.css"
    />
    <link
            rel="stylesheet"
            type="text/css"
            href="css/javascript.js"
    />
</head>
<body>

<nav class="top-nav">
    <ul>
        <li>
            <a href="">
                Home
            </a>
        </li>
        <li>
            <a href="">
                Accounts
            </a>
        </li>
        <li>
            <a href="">
                Users
            </a>
        </li>
        <li>
            <a href="">
                Transactions
            </a>
        </li>
        <li class="btn-login">
            <a href="">
                Login
            </a>
        </li>
    </ul>
</nav>

<div id="section-landing">
    <div class="wrapper-landing">
        <h1>
            Create transaction
        </h1>
        <a href="createtransaction.html" class="createtransaction-btn">
            See all transactions
        </a>
    </div>
</div>
<div id="currentuser"></div>

<div class="create-transaction">
    <div>
        <h2>
            Account from:
        </h2>

        <h2>
            Account to:
        </h2>

        <h2>
            Amount:
        </h2>
    </div>

    <div class="form-create-transaction">

        <form id="createNewTransaction" class="createTransactionForm">

            <input type="text" name="account_from" placeholder="Example: NL00INHO0123456789">

            <input type="text" name="account_to" placeholder="Example: NL00INHO0123456789">

            <input type="number" name="amount" placeholder="0,00">

            <button
                    type="button"
                    name="submit"
                    onclick="createNewTransaction();">
                SEND
            </button>

        </form>

    </div>
</div>

</body>
<script>

    window.onload = function() {
        var userId = sessionStorage.getItem("UserId");

        if (userId === null) {
            document.getElementById("currentuser").innerHTML = "Not logged in";
        }
        else {
            document.getElementById("currentuser").innerHTML = "Hello user '" + userId + "'";
        }
    }

    function createNewTransaction() {

        var xhr =  new XMLHttpRequest();
        xhr.open('POST','http://localhost:8080/transactions');
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.setRequestHeader("ApiKeyAuth", sessionStorage.getItem("AuthToken"));
        xhr.onload= (e) => {
            alert(xhr.status);
            location.reload();
        }
        xhr.send(JSON.stringify(
            {
                "account_from": document.forms["createNewTransaction"]["account_from"].value,
                "account_to": document.forms["createNewTransaction"]["account_to"].value,
                "amount": document.forms["createNewTransaction"]["amount"].value
            }
        ));

    }
</script>
</html>
